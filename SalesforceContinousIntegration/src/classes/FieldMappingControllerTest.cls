@isTest
public class FieldMappingControllerTest {

    @testSetup static void createData(){
	     User auser = Utility_Test.createUser('testdummy@zycustest.com');
         insert auser;
         Basic_Authentication__c ba = new Basic_Authentication__c(Username__c = 'test', Password__c = 'test', Application_Id__c = 'test');
		 insert ba;        
    }
    
    
    @isTest static void getTypeAndSubTypeMaptestmethod1(){
        Test.setMock(HttpCalloutMock.class, new FieldMetadataMockHttpResponseGenerator());
        User userObj 	= [Select Id from User where UserName = 'testdummy@zycustest.com'];
        Test.startTest();
        System.runAs(userObj){
         	FetchMetadataAPICtrl.Response respObj = FieldMappingController.service();   
            System.assert(respObj != null);
            Mapping_Configurations__c configObj = Utility_Test.createMappingConfig('Test 1', 'Test 2');
            insert configObj;
            insert Utility_Test.createMappingConfig('Test 3', 'Test 4');
            String fieldData = '[{"fieldName":"Contract_Title","displayName":"Contract Title","dataType":"String","length":"0","mandatory":"YES","allowedValues":"","defaultValue":"","applicableModules":"Repository, Authoring","contractRelationship":"ONE-ONE","dependantFields":"","isSelected":true},{"fieldName":"Facilities_Section","displayName":"Facilities Section","dataType":"list","length":"0","mandatory":"YES","allowedValues":"Maintenance,Project,Accommodation,Supply and service","defaultValue":"","applicableModules":"Repository, Authoring","contractRelationship":"ONE-ONE","dependantFields":"","isSelected":true},{"fieldName":"Contract_Value","displayName":"Contract Value","dataType":"BigDecimal","length":"0","mandatory":"YES","allowedValues":"","defaultValue":"0.0","applicableModules":"Repository, Authoring","contractRelationship":"ONE-ONE","dependantFields":"","isSelected":true},{"fieldName":"Region","displayName":"Region","dataType":"list","length":"0","mandatory":"YES","allowedValues":"Global,UAE,Middle East,Asia,Europe,Australia,US,MENA","defaultValue":"","applicableModules":"Repository, Authoring","contractRelationship":"ONE-ONE","dependantFields":"","isSelected":true},{"fieldName":"Base_Currency","displayName":"Currency","dataType":"list","length":"0","mandatory":"YES","allowedValues":"AED,USD,EURO,GBP","defaultValue":"","applicableModules":"Repository, Authoring","contractRelationship":"ONE-ONE","dependantFields":"","isSelected":true},{"fieldName":"Payment_Term","displayName":"Payment Terms","dataType":"list","length":"0","mandatory":"YES","allowedValues":"30 days,Yes,No","defaultValue":"","applicableModules":"Repository, Authoring","contractRelationship":"ONE-ONE","dependantFields":"","isSelected":true},{"fieldName":"Contract_Category","displayName":"Contract Category","dataType":"list","length":"0","mandatory":"YES","allowedValues":"Advertising,Printing,Promotions,Giveaways,Sponsorships,Labour Supply,Uniform and Laundry Services,Medical Services,General Purchases,Ground Support Equipment,Cargo Equipments,Transportation Services,Logistics,Software,Hardware,IT Professional Services,Telecom,IFS,Miscellaneous,General Purchasing-Miscellaneous,Market Research,Special Projects,Catering services,Visa Service Agreements,Office Supplies,Refreshments,Media Relations,Fit out,Signage,Furniture & Fixtures,Accommodation,Equipment Maintenance,Indoor Plants & Landscaping,Building Maintenance,Fire & Safety","defaultValue":"","applicableModules":"Repository, Authoring","contractRelationship":"ONE-ONE","dependantFields":"","isSelected":true},{"fieldName":"Contract_Effective_Date","displayName":"Contract Start Date","dataType":"Date","length":"0","mandatory":"YES","allowedValues":"","defaultValue":"","applicableModules":"Repository, Authoring","contractRelationship":"ONE-ONE","dependantFields":"","isSelected":true},{"fieldName":"Contract_Expiration_Date","displayName":"Contract End Date","dataType":"Date","length":"0","mandatory":"YES","allowedValues":"","defaultValue":"","applicableModules":"Repository, Authoring","contractRelationship":"ONE-ONE","dependantFields":"","isSelected":true},{"fieldName":"Contract_Renewal_Date","displayName":"Contract Review Date","dataType":"Date","length":"0","mandatory":"NO","allowedValues":"","defaultValue":"","applicableModules":"Repository, Authoring","contractRelationship":"ONE-ONE","dependantFields":"","isSelected":true},{"fieldName":"Contract_Signing_Date","displayName":"Contract Signed On","dataType":"Date","length":"0","mandatory":"NO","allowedValues":"","defaultValue":"","applicableModules":"Repository","contractRelationship":"ONE-ONE","dependantFields":"","isSelected":true},{"fieldName":"Contract_Owner","displayName":"Buyer Email","dataType":"String","length":"0","mandatory":"YES","allowedValues":"","defaultValue":"AUTOPOPULATE:EMAIL ADDRESS","applicableModules":"Repository, Authoring","contractRelationship":"ONE-ONE","dependantFields":"","isSelected":true},{"fieldName":"Business__Contact_1","displayName":"Business  Contact 1","dataType":"String","length":"0","mandatory":"NO","allowedValues":"","defaultValue":"","applicableModules":"Repository, Authoring","contractRelationship":"ONE-ONE","dependantFields":"","isSelected":true},{"fieldName":"Business__Contact_2","displayName":"Business  Contact 2","dataType":"String","length":"0","mandatory":"NO","allowedValues":"","defaultValue":"","applicableModules":"Repository, Authoring","contractRelationship":"ONE-ONE","dependantFields":"","isSelected":true},{"fieldName":"Insurance_Reviewer","displayName":"Insurance Reviewer","dataType":"String","length":"0","mandatory":"YES","allowedValues":"","defaultValue":"","applicableModules":"Repository","contractRelationship":"ONE-ONE","dependantFields":"","isSelected":true},{"fieldName":"Performance_Bond_Amount","displayName":"Performance Bond Amount","dataType":"BigDecimal","length":"0","mandatory":"YES","allowedValues":"","defaultValue":"","applicableModules":"Repository","contractRelationship":"ONE-ONE","dependantFields":"","isSelected":true},{"fieldName":"Bond_Currency","displayName":"Performance Bond Currency","dataType":"list","length":"0","mandatory":"YES","allowedValues":"AED,USD,EURO,GBP","defaultValue":"","applicableModules":"Repository","contractRelationship":"ONE-ONE","dependantFields":"","isSelected":true},{"fieldName":"Additional_Information_1","displayName":"Additional Information 1","dataType":"TEXT_AREA","length":"0","mandatory":"NO","allowedValues":"","defaultValue":"","applicableModules":"Repository, Authoring","contractRelationship":"ONE-ONE","dependantFields":"","isSelected":true},{"fieldName":"Additional_Information_2","displayName":"Additional Information 2","dataType":"TEXT_AREA","length":"0","mandatory":"NO","allowedValues":"","defaultValue":"","applicableModules":"Repository, Authoring","contractRelationship":"ONE-ONE","dependantFields":"","isSelected":true},{"fieldName":"Additional_Information_3","displayName":"Additional Information 3","dataType":"TEXT_AREA","length":"0","mandatory":"NO","allowedValues":"","defaultValue":"","applicableModules":"Repository, Authoring","contractRelationship":"ONE-ONE","dependantFields":"","isSelected":true},{"fieldName":"Business_Units","displayName":"Business Unit","dataType":"String","length":"0","mandatory":"YES","allowedValues":"","defaultValue":"","isSelected":true},{"fieldName":"BU Address","displayName":"Address","dataType":"TEXT_AREA","length":"0","mandatory":"NO","allowedValues":"","defaultValue":"","isSelected":true},{"fieldName":"Code","displayName":"Code","dataType":"String","length":"0","mandatory":"NO","allowedValues":"","defaultValue":"","isSelected":true},{"fieldName":"Status1","displayName":"Status","dataType":"list","length":"0","mandatory":"YES","allowedValues":"Active, Disable","defaultValue":"","isSelected":true},{"fieldName":"Contract_Status","displayName":"Contract Status","dataType":"list","length":"0","mandatory":"YES","allowedValues":"Active,Inactive,Expired","applicableModules":"Repository","contractRelationship":"ONE-ONE","dependantFields":"","isSelected":true},{"fieldName":"Heirarchy_Status","displayName":"Hierarchy Status","dataType":"list","length":"0","mandatory":"YES","allowedValues":"Master Agreement,Standalone,Sub Agreement","applicableModules":"Repository","contractRelationship":"ONE-ONE","dependantFields":"","isSelected":true},{"fieldName":"Folder","displayName":"Folder","dataType":"list","length":"0","mandatory":"YES","allowedValues":"All Contracts","applicableModules":"Repository","contractRelationship":"ONE-ONE","dependantFields":"","isSelected":true},{"fieldName":"TIMEZONE","displayName":"Contract Timezone","dataType":"list","length":"0","mandatory":"YES","allowedValues":"","applicableModules":"Repository, Authoring","contractRelationship":"ONE-ONE","dependantFields":"","isSelected":true},{"fieldName":"AUTO_RENEW","displayName":"Is Evergreen","dataType":"list","length":"","mandatory":"YES","allowedValues":"Auto Renew,Yes,No","defaultValue":"","applicableModules":"Repository, Authoring","contractRelationship":"ONE-ONE","dependantFields":"renewalNotice,renewalPeriod,maxRenewal,Contract_Renewal_Date","isSelected":true},{"fieldName":"renewalNotice","displayName":"Renewal Notice (Days)","dataType":"Integer","length":"","mandatory":"YES","allowedValues":"","defaultValue":"","applicableModules":"Repository, Authoring","contractRelationship":"ONE-ONE","dependantFields":"","isSelected":true},{"fieldName":"renewalPeriod","displayName":"Renewal Period (Months)","dataType":"Integer","length":"","mandatory":"YES","allowedValues":"","defaultValue":"","applicableModules":"Repository, Authoring","contractRelationship":"ONE-ONE","dependantFields":"","isSelected":true},{"fieldName":"maxRenewal","displayName":"Maximum Number of Renewals (Remaining)","dataType":"Integer","length":"","mandatory":"YES","allowedValues":"","defaultValue":"","applicableModules":"Repository, Authoring","contractRelationship":"ONE-ONE","dependantFields":"","isSelected":true},{"fieldName":"isContractConfidential","displayName":"Is Contract Confidential?","dataType":"list","length":"","mandatory":"YES","allowedValues":"Yes,No","defaultValue":"No","applicableModules":"Repository","contractRelationship":"ONE-ONE","dependantFields":"isConfidentialContractSearchable","isSelected":true},{"fieldName":"isConfidentialContractSearchable","displayName":"Is Confidential Contract Searchable?","dataType":"radio","length":"","mandatory":"YES","allowedValues":"Yes,No","defaultValue":"Yes","applicableModules":"Repository","contractRelationship":"ONE-ONE","dependantFields":"","isSelected":true}]';
			//IContract_MetaData__c icMDObj 	= Utility_Test.createIconMetadata('test', 'Test 1', 'Test 2');
            //insert icMDObj;
            
            List<String> existFieldsList    =   FieldMappingController.getExistingSelFieldRecords('Test 1', 'Test 2');
            System.assert(existFieldsList.isEmpty());
            List<Mapping_Configurations__c> mappingList     = FieldMappingController.getContractMappingRecords();
            FieldMappingController.createFieldsMetadata('Test 1', 'Test 2', fieldData);
            Value_Mapping__c valMappingObj 	= Utility_Test.valueMapping('test', 'Test 1', 'Test 2', 'test', 'test', 'test', 'test');
            valMappingObj.IContract_Field_Metadata__c = [Select Id from IContract_MetaData__c LIMIT 1].Id;
            insert valMappingObj;
            FieldMappingController.copyContract(configObj.id, 'Test 3', 'Test 4');
            FieldMappingController.activateContract(configObj.id);
            System.assert([Select Id,Status__c from Mapping_Configurations__c where Id =: configObj.id].Status__c == Constants.MAPPING_CONFIG_ACTIVE_STATUS);
            FieldMappingController.deactivateContract(configObj.id);
            System.assert([Select Id,Status__c from Mapping_Configurations__c where Id =: configObj.id].Status__c == Constants.MAPPING_CONFIG_INACTIVE_STATUS);
            FieldMappingController.deleteContract(configObj.id);
            FieldMappingController.deleteContract(null);
            
        }
        Test.stopTest();
    }
}